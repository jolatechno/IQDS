\hypertarget{vector_8hpp_source}{}\doxysection{vector.\+hpp}
\label{vector_8hpp_source}\index{/home/joseph/Documents/projets/programing/cpp/Quantum-\/graph-\/simulation/src/QuIDS/src/utils/vector.hpp@{/home/joseph/Documents/projets/programing/cpp/Quantum-\/graph-\/simulation/src/QuIDS/src/utils/vector.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{2 }
\DoxyCodeLine{3 \textcolor{preprocessor}{\#include <stdexcept>}}
\DoxyCodeLine{4 \textcolor{preprocessor}{\#include <iterator>}     \textcolor{comment}{// std::iterator, std::input\_iterator\_tag}}
\DoxyCodeLine{5 \textcolor{preprocessor}{\#include <algorithm>}}
\DoxyCodeLine{6 }
\DoxyCodeLine{7 \textcolor{comment}{/* default variables preprocessor definition:}}
\DoxyCodeLine{8 \textcolor{comment}{    -\/ "{}UPSIZE\_POLICY"{} corresponds to "{}upsize\_policy"{} (described in iteration\_t resize operators).}}
\DoxyCodeLine{9 \textcolor{comment}{    -\/ "{}DOWNSIZE\_POLICY"{} corresponds to "{}downsize\_policy"{} (described in iteration\_t resize operators).}}
\DoxyCodeLine{10 \textcolor{comment}{    -\/ "{}MIN\_VECTOR\_SIZE"{} corresponds to "{}min\_state\_size"{} which is the smallest size of a vector (described in iteration\_t resize operators).}}
\DoxyCodeLine{11 \textcolor{comment}{*/}}
\DoxyCodeLine{12 \textcolor{preprocessor}{\#ifndef UPSIZE\_POLICY}}
\DoxyCodeLine{13 \textcolor{preprocessor}{    \#define UPSIZE\_POLICY 1.1}}
\DoxyCodeLine{14 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{15 \textcolor{preprocessor}{\#ifndef DOWNSIZE\_POLICY}}
\DoxyCodeLine{16 \textcolor{preprocessor}{    \#define DOWNSIZE\_POLICY 0.85}}
\DoxyCodeLine{17 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{18 \textcolor{preprocessor}{\#ifndef MIN\_VECTOR\_SIZE}}
\DoxyCodeLine{19 \textcolor{preprocessor}{    \#define MIN\_VECTOR\_SIZE 1000}}
\DoxyCodeLine{20 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{21 }
\DoxyCodeLine{23 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacequids_1_1utils}{quids::utils}} \{}
\DoxyCodeLine{24 }
\DoxyCodeLine{26     \textcolor{keywordtype}{float} \mbox{\hyperlink{namespacequids_1_1utils_a90041f6130e71de649d376e77040893d}{upsize\_policy}} = UPSIZE\_POLICY;}
\DoxyCodeLine{28     \textcolor{keywordtype}{float} \mbox{\hyperlink{namespacequids_1_1utils_a1030df3ee43b5a7caf2fcc8e4e68e281}{downsize\_policy}} = DOWNSIZE\_POLICY;}
\DoxyCodeLine{30     \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{namespacequids_1_1utils_af6008a56b61821492cabc5d71d351938}{min\_vector\_size}} = MIN\_VECTOR\_SIZE;}
\DoxyCodeLine{31 }
\DoxyCodeLine{33     \textcolor{keyword}{template} <\textcolor{keyword}{typename} value\_type>}
\DoxyCodeLine{34     \textcolor{keyword}{class }\mbox{\hyperlink{classquids_1_1utils_1_1fast__vector}{fast\_vector}}\textcolor{comment}{/*numa\_vector*/} \{}
\DoxyCodeLine{35     \textcolor{keyword}{private}:}
\DoxyCodeLine{36         \textcolor{keyword}{mutable} value\_type* ptr = NULL;}
\DoxyCodeLine{37         \textcolor{keyword}{mutable} \textcolor{keywordtype}{size\_t} size\_ = 0;}
\DoxyCodeLine{38      }
\DoxyCodeLine{39     \textcolor{keyword}{public}:}
\DoxyCodeLine{40         \textcolor{keyword}{explicit} \mbox{\hyperlink{classquids_1_1utils_1_1fast__vector}{fast\_vector}}(\textcolor{keywordtype}{size\_t} n = 0) \{}
\DoxyCodeLine{41             resize(n);}
\DoxyCodeLine{42         \}}
\DoxyCodeLine{43 }
\DoxyCodeLine{44         \mbox{\hyperlink{classquids_1_1utils_1_1fast__vector}{\string~fast\_vector}}() \{}
\DoxyCodeLine{45             \textcolor{keywordflow}{if} (ptr != NULL) \{}
\DoxyCodeLine{46                 free(ptr);}
\DoxyCodeLine{47                 ptr = NULL;}
\DoxyCodeLine{48                 size\_ = 0;}
\DoxyCodeLine{49             \}}
\DoxyCodeLine{50         \}}
\DoxyCodeLine{51      }
\DoxyCodeLine{52         \textcolor{comment}{// NOT SUPPORTED !!!}}
\DoxyCodeLine{53         \textcolor{keywordtype}{size\_t} push\_back(value\_type) \{}
\DoxyCodeLine{54             exit(0);}
\DoxyCodeLine{55             \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{56         \}}
\DoxyCodeLine{57      }
\DoxyCodeLine{58         \textcolor{comment}{// function that returns the popped element}}
\DoxyCodeLine{59         value\_type pop\_back() \{}
\DoxyCodeLine{60             \textcolor{keywordflow}{return} ptr[size\_-\/-\/ -\/ 1];}
\DoxyCodeLine{61         \}}
\DoxyCodeLine{62      }
\DoxyCodeLine{63         \textcolor{comment}{// Function that return the size of vector}}
\DoxyCodeLine{64         \textcolor{keywordtype}{size\_t} size()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{65             \textcolor{keywordflow}{return} size\_;}
\DoxyCodeLine{66         \}}
\DoxyCodeLine{67 }
\DoxyCodeLine{68         value\_type\& operator[](\textcolor{keywordtype}{size\_t} index) \{}
\DoxyCodeLine{69             \textcolor{keywordflow}{return} *(ptr + index);}
\DoxyCodeLine{70         \}}
\DoxyCodeLine{71 }
\DoxyCodeLine{72         value\_type operator[](\textcolor{keywordtype}{size\_t} index)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{73             \textcolor{keywordflow}{return} *(ptr + index);}
\DoxyCodeLine{74         \}}
\DoxyCodeLine{75 }
\DoxyCodeLine{76         \textcolor{comment}{/*}}
\DoxyCodeLine{77 \textcolor{comment}{        "{}upsize\_policy"{} is a multiplier (>1) that forces any upsize to add a margin to avoid frequent resize.}}
\DoxyCodeLine{78 \textcolor{comment}{        "{}downsize\_policy"{} is a multiplier (<1) that forces a down\_size to free memory only if the freed memory exceed the downsize\_policy}}
\DoxyCodeLine{79 \textcolor{comment}{            (to allow memory to be freed and given back to another vector).}}
\DoxyCodeLine{80 \textcolor{comment}{        "{}min\_state\_size"{} is the minimum size of a vector, to avoid small vectors which are bound to be resized frequently.}}
\DoxyCodeLine{81 \textcolor{comment}{        */}}
\DoxyCodeLine{82         \textcolor{keywordtype}{void} resize(\textcolor{keywordtype}{size\_t} n)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{83             n = std::max(\mbox{\hyperlink{namespacequids_1_1utils_af6008a56b61821492cabc5d71d351938}{min\_vector\_size}}, n); \textcolor{comment}{// never resize under min\_vector\_size}}
\DoxyCodeLine{84 }
\DoxyCodeLine{85             \textcolor{keywordflow}{if} (size\_ < n || \textcolor{comment}{// resize if we absolutely have to because the state won't fit}}
\DoxyCodeLine{86                 n*\mbox{\hyperlink{namespacequids_1_1utils_a90041f6130e71de649d376e77040893d}{upsize\_policy}} < size\_*\mbox{\hyperlink{namespacequids_1_1utils_a1030df3ee43b5a7caf2fcc8e4e68e281}{downsize\_policy}}) \{ \textcolor{comment}{// resize if the size we resize to is small enough (to free memory)}}
\DoxyCodeLine{87                 size\_ = n*\mbox{\hyperlink{namespacequids_1_1utils_a90041f6130e71de649d376e77040893d}{upsize\_policy}};}
\DoxyCodeLine{88                 ptr = (value\_type*)realloc(ptr, size\_*\textcolor{keyword}{sizeof}(value\_type));}
\DoxyCodeLine{89 }
\DoxyCodeLine{90                 \textcolor{keywordflow}{if} (ptr == NULL)}
\DoxyCodeLine{91                     \textcolor{keywordflow}{throw} std::runtime\_error(\textcolor{stringliteral}{"{}bad allocation in fast\_vector !!"{}});}
\DoxyCodeLine{92             \}}
\DoxyCodeLine{93         \}}
\DoxyCodeLine{94      }
\DoxyCodeLine{95         \textcolor{comment}{// Begin iterator}}
\DoxyCodeLine{96         \textcolor{keyword}{inline} value\_type* begin()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{97             \textcolor{keywordflow}{return} ptr;}
\DoxyCodeLine{98         \}}
\DoxyCodeLine{99      }
\DoxyCodeLine{100         \textcolor{comment}{// End iterator}}
\DoxyCodeLine{101         \textcolor{keyword}{inline} value\_type* end()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{102             \textcolor{keywordflow}{return} begin() + size\_;}
\DoxyCodeLine{103         \}}
\DoxyCodeLine{104     \};}
\DoxyCodeLine{105 \}}

\end{DoxyCode}
